# 요약

- 해시 재배치 문제: 해시 알고리즘이 서버수를 기반으로 moduler연산을 할 때 서버의 수가 줄어들거나 늘어나면 모든 값들을 재해싱해야하는 문제

## 안정 해시

- 해시테이블을 (해시키의 개수)/(슬롯 개수) 만 키를 재배치

## 기본 안정 해시

- 서버와 키가 같은 해시테이블에 존재
- 특정 서버는 slot의 파티션을 많이 차지하는 불균형 문제가 발생
- 서버가 늘어나거나 줄어들면서 문제가 발생

### 해시를 이용한 서버를 찾는 로직

1. 해시로 나올 수 있는 모든 경우의 수를 slot이며 첫번째 해시와 마지막 해시를 이어서 링 형태로 만든다
2. 서버를 호스트이름 혹은 ip를 기준으로 해싱해 slot중 하나에 배치한다
3. Key를 해싱해 slot에 배치한다
4. Key와 매칭되는 value는 링 형태에서 시계방향으로 찾는다
5. 가장 먼저 만나는 서버가 해시에 매칭되는 캐시가 존재함


## 가상 노드를 이용한 균등 분포

- 기본 안정 해시의 문제점인 균등 배포의 어려움을 해결
- 실제 서버가 아닌 서버를 가리키는 노드들을 여러개로 분포
- 서버의 분포도만큼 더 많은 서버가 분포됨
- **해시를 이용한 서버를 찾는 로직** 에서 먼저 만나는 서버가 아닌 노드로 바뀜
- 서버가 제거되어 캐시를 재배칭을 해야하는 상황에서도 **해시를 이용한 서버를 찾는 로직** 과 동일한 과정으로 캐시 서버를 찾아 재배치
